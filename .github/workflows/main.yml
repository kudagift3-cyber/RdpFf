name: AvicaRDP

on:
  workflow_dispatch:
  schedule:
    - cron: '0 */6 * * *' # ржкрзНрж░рждрж┐ рзм ржШржгрзНржЯрж╛ ржкрж░ ржкрж░ ржЕржЯрзЛ рж░рж┐рж╕рзНржЯрж╛рж░рзНржЯ рж╣ржмрзЗ

jobs:
  build:
    name: Start Building...
    runs-on: windows-latest
    timeout-minutes: 350

    steps:
      - name: Direct Avica Setup
        run: |
          Write-Host "ЁЯЪА Starting Avica setup directly..." -ForegroundColor Green
          
          # ржлрж╛ржЗрж▓ржЧрзБрж▓рзЛ рж╕рж░рж╛рж╕рж░рж┐ ржбрж╛ржЙржирж▓рзЛржб ржХрж░рж╛ рж╣ржЪрзНржЫрзЗ
          Invoke-WebRequest -Uri "https://gitlab.com/userup908/my-rdp/-/raw/main/setup.py" -OutFile "setup.py"
          Invoke-WebRequest -Uri "https://download.avica.com/AvicaLite_v8.0.8.9.exe" -OutFile "Avica_setup.exe"
          Invoke-WebRequest -Uri "https://gitlab.com/userup908/my-rdp/-/raw/main/show.bat" -OutFile "show.bat"
          Invoke-WebRequest -Uri "https://gitlab.com/userup908/my-rdp/-/raw/main/loop.bat" -OutFile "loop.bat"
          
          # ржкрзНрж░рзЯрзЛржЬржирзАрзЯ ржкрж╛ржЗржержи ржкрзНржпрж╛ржХрзЗржЬ ржЗржирж╕рзНржЯрж▓ ржХрж░рж╛ рж╣ржЪрзНржЫрзЗ
          python.exe -m pip install requests pyautogui telegraph --quiet
          
          # RDP ржЪрж╛рж▓рзБ ржХрж░рж╛ рж╣ржЪрзНржЫрзЗ
          Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server' -name "fDenyTSConnections" -value 0
          Enable-NetFirewallRule -DisplayGroup "Remote Desktop"
          
          # ржЗржЙржЬрж╛рж░рзЗрж░ ржкрж╛рж╕ржУрзЯрж╛рж░рзНржб рж╕рзЗржЯ ржХрж░рж╛ рж╣ржЪрзНржЫрзЗ
          net user runneradmin TheDisa1a
          
          # Avica ржЪрж╛рж▓рзБ ржХрж░рж╛ ржПржмржВ рж╕рзНржХрзНрж░рж┐ржирж╢ржЯ ржирзЗржУрзЯрж╛
          Write-Host "тЪб Starting Avica..." -ForegroundColor Yellow
          Start-Process "Avica_setup.exe"
          
          Write-Host "тП│ Avica ржЗржирж╕рзНржЯрж▓рж╛рж░ ржЪрж╛рж▓рзБ рж╣ржУрзЯрж╛рж░ ржЬржирзНржп ржЕржкрзЗржХрзНрж╖рж╛ ржХрж░рж╛ рж╣ржЪрзНржЫрзЗ..." -ForegroundColor Cyan
          Start-Sleep -Seconds 15
          
          Write-Host "ЁЯЦея╕П рж╕ржм ржЙржЗржирзНржбрзЛ ржорж┐ржирж┐ржорж╛ржЗржЬ ржХрж░рж╛ рж╣ржЪрзНржЫрзЗ..." -ForegroundColor Cyan
          (New-Object -ComObject Shell.Application).MinimizeAll()
          Start-Sleep -Seconds 3
          
          # рж╕рзЗржЯржЖржк рж╕рзНржХрзНрж░рж┐ржкрзНржЯ ржЪрж╛рж▓рж╛ржирзЛ рж╣ржЪрзНржЫрзЗ (ржПржЯрж┐ рж╕рзНржмрзЯржВржХрзНрж░рж┐рзЯржнрж╛ржмрзЗ ржЗржирж╕рзНржЯрж▓рзЗрж╢ржи ржПржмржВ рж╕рзНржХрзНрж░рж┐ржирж╢ржЯ ржирзЗржмрзЗ)
          python setup.py
          
          Write-Host "тЬЕ Setup completed! Check for GoFile link!" -ForegroundColor Green

      - name: Show Connection Info
        run: |
          Write-Host "
          тХФтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХЧ
          тХС         AVICA RDP CONNECTION         тХС
          тХЪтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХЭ
          
          ЁЯУ▒ Telegram : @Aditya_L7
          ЁЯСитАНЁЯТ╗ Credits : @Aditya_L7
          
          ЁЯУЛ Instructions:
          тАв Go to the GoFile link that will appear below
          тАв Get Avica ID and Password from there
          тАв Download Avica app and connect
          тАв GoFile link changes every time!
          
          тП│ Waiting for GoFile link...
          " -ForegroundColor Cyan
      
      - name: Start Avica Service
        run: cmd /c show.bat
        
      - name: Keep Session Active
        run: |
          Write-Host "ЁЯЪА Avica is starting... Look for CONNECTION ID below!" -ForegroundColor Yellow
          cmd /c loop.bat
