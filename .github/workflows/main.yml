name: AvicaRDP

on:
  workflow_dispatch:
  schedule:
    - cron: '0 */6 * * *' # à¦ªà§à¦°à¦¤à¦¿ à§¬ à¦˜à¦£à§à¦Ÿà¦¾ à¦ªà¦° à¦ªà¦° à¦…à¦Ÿà§‹ à¦°à¦¿à¦¸à§à¦Ÿà¦¾à¦°à§à¦Ÿ

jobs:
  build:
    name: Start Building...
    runs-on: windows-latest
    timeout-minutes: 350

    steps:
      - name: Direct Avica Setup
        run: |
          Write-Host "ğŸš€ Starting Avica setup directly..." -ForegroundColor Green
          
          # à¦«à¦¾à¦‡à¦²à¦—à§à¦²à§‹ à¦¸à¦°à¦¾à¦¸à¦°à¦¿ à¦¡à¦¾à¦‰à¦¨à¦²à§‹à¦¡ à¦•à¦°à¦¾ à¦¹à¦šà§à¦›à§‡
          try {
            Invoke-WebRequest -Uri "https://gitlab.com/userup908/my-rdp/-/raw/main/setup.py" -OutFile "setup.py" -ErrorAction Stop
            Invoke-WebRequest -Uri "https://download.avica.com/AvicaLite_v8.0.8.9.exe" -OutFile "Avica_setup.exe" -ErrorAction Stop
            Invoke-WebRequest -Uri "https://gitlab.com/userup908/my-rdp/-/raw/main/show.bat" -OutFile "show.bat" -ErrorAction Stop
            Invoke-WebRequest -Uri "https://gitlab.com/userup908/my-rdp/-/raw/main/loop.bat" -OutFile "loop.bat" -ErrorAction Stop
            Write-Host "âœ… All files downloaded successfully!" -ForegroundColor Green
          } catch {
            Write-Host "âŒ Error downloading files: $($_.Exception.Message)" -ForegroundColor Red
            exit 1
          }
          
          # à¦ªà§à¦°à¦¯à¦¼à§‹à¦œà¦¨à§€à¦¯à¦¼ à¦ªà¦¾à¦‡à¦¥à¦¨ à¦ªà§à¦¯à¦¾à¦•à§‡à¦œ à¦‡à¦¨à¦¸à§à¦Ÿà¦²
          Write-Host "ğŸ“¦ Installing Python packages..." -ForegroundColor Yellow
          python.exe -m pip install requests pyautogui telegraph --quiet
          
          # RDP à¦šà¦¾à¦²à§ à¦•à¦°à¦¾ à¦¹à¦šà§à¦›à§‡ - à¦¸à¦ à¦¿à¦• Registry Path
          Write-Host "ğŸ”§ Enabling RDP..." -ForegroundColor Yellow
          try {
            Set-ItemProperty -Path 'HKLM:SystemCurrentControlSetControlTerminal Server' -Name "fDenyTSConnections" -Value 0 -ErrorAction Stop
            Enable-NetFirewallRule -DisplayGroup "Remote Desktop" -ErrorAction Stop
            Write-Host "âœ… RDP enabled successfully!" -ForegroundColor Green
          } catch {
            Write-Host "âš ï¸ RDP configuration warning: $($_.Exception.Message)" -ForegroundColor Yellow
            # Continue anyway as this might not be critical
          }
          
          # à¦‡à¦‰à¦œà¦¾à¦°à§‡à¦° à¦ªà¦¾à¦¸à¦“à¦¯à¦¼à¦¾à¦°à§à¦¡ à¦¸à§‡à¦Ÿ à¦•à¦°à¦¾
          Write-Host "ğŸ‘¤ Setting user password..." -ForegroundColor Yellow
          net user runneradmin TheDisa1a
          
          # Avica à¦‡à¦¨à¦¸à§à¦Ÿà¦²à§‡à¦¶à¦¨ à¦¶à§à¦°à§
          Write-Host "âš¡ Starting Avica installation..." -ForegroundColor Yellow
          Start-Process "Avica_setup.exe" -WindowStyle Minimized
          
          # à¦‡à¦¨à¦¸à§à¦Ÿà¦²à§‡à¦¶à¦¨à§‡à¦° à¦œà¦¨à§à¦¯ à¦…à¦ªà§‡à¦•à§à¦·à¦¾
          Write-Host "â³ Waiting for Avica installation..." -ForegroundColor Cyan
          Start-Sleep -Seconds 20
          
          # à¦¸à¦¬ à¦‰à¦‡à¦¨à§à¦¡à§‹ à¦®à¦¿à¦¨à¦¿à¦®à¦¾à¦‡à¦œ à¦•à¦°à¦¾
          Write-Host "ğŸ–¥ï¸ Minimizing all windows..." -ForegroundColor Cyan
          try {
            (New-Object -ComObject Shell.Application).MinimizeAll()
            Start-Sleep -Seconds 5
          } catch {
            Write-Host "âš ï¸ Could not minimize windows" -ForegroundColor Yellow
          }
          
          # à¦¸à§‡à¦Ÿà¦†à¦ª à¦¸à§à¦•à§à¦°à¦¿à¦ªà§à¦Ÿ à¦šà¦¾à¦²à¦¾à¦¨à§‹
          Write-Host "ğŸ”§ Running setup script..." -ForegroundColor Yellow
          python setup.py
          
          Write-Host "âœ… Setup completed! Check for GoFile link!" -ForegroundColor Green

      - name: Show Connection Info
        run: |
          Write-Host "
          â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
          â•‘         AVICA RDP CONNECTION         â•‘
          â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          
          ğŸ“± Telegram : @Aditya_L7
          ğŸ‘¨â€ğŸ’» Credits : @Aditya_L7
          
          ğŸ“‹ Instructions:
          â€¢ Go to the GoFile link that will appear below
          â€¢ Get Avica ID and Password from there
          â€¢ Download Avica app and connect
          â€¢ GoFile link changes every time!
          
          ğŸ”‘ Default RDP Credentials:
          â€¢ Username: runneradmin
          â€¢ Password:
